<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style.css">
</head>
<body>

<script type="module">
  import { supabase } from "./supabase.js";
  const { data: { session } } = await supabase.auth.getSession();
  if (!session) window.location.href = "index.html";
</script>

<div class="box">
  <h1>ğŸ“º Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª</h1>

  <p>Ø´Ø§Ù‡Ø¯ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ù„ØªØ­ØµÙ„ Ø¹Ù„Ù‰ Ù†Ù‚Ø§Ø·</p>

  <button onclick="watchAd()">â–¶ï¸ Ù…Ø´Ø§Ù‡Ø¯Ø© Ø¥Ø¹Ù„Ø§Ù†</button>
  <p id="msg"></p>

  <br>
  <a href="home.html">â¬…ï¸ Ø±Ø¬ÙˆØ¹</a>
</div>

<script type="module">
  import { supabase } from "./supabase.js";

  window.watchAd = async () => {
    const msg = document.getElementById("msg");
    msg.innerText = "â³ Ø¬Ø§Ø±ÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø´Ø§Ù‡Ø¯Ø©...";

    const { data: { session } } = await supabase.auth.getSession();
    const user = session.user;

    const { error } = await supabase
      .from("ad_views")
      .insert({ user_id: user.id, ad_id: 1 });

    if (error) {
      msg.innerText = error.message;
    } else {
      msg.innerText = "âœ… ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø´Ø§Ù‡Ø¯Ø© + Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù†Ù‚Ø§Ø·";
    }
  };
</script>

</body>
</html>
